import random

from django.core.management import BaseCommand

from maistorbox.accounts.models import BaseUserModel
from maistorbox.common.models import ContractorPublicModel, ClientFeedbackModel

feedbacks = [
            # Short feedbacks
            "Добра работа, свърши задачата в срок.",
            "Работата не ме впечатли особено.",

            # Medium feedbacks
            "Майсторът беше точен и свърши задачата коректно, но комуникацията можеше да бъде по-добра.",
            "Не съм доволен от резултата. Очакванията ми не бяха изпълнени и качеството не беше на ниво.",

            # Longer feedbacks
            "Майсторът се справи доста добре. Работата беше изпълнена качествено и в срок. Единствената ми забележка е, че можеше да бъде по-организиран и да обяснява процеса по-ясно, но като цяло съм доволен.",
            "Много съм впечатлен от качеството на работа. Майсторът беше изключително професионален, вежлив и бърз. Цената беше напълно оправдана спрямо получения резултат. Ще го препоръчам на приятели и семейство.",
            "Добър майстор, който си разбира от работата. Задачата беше изпълнена точно както беше договорено. Нямаха забележки относно крайната обработка и времето, в което проектът беше завършен.",
            "Работата беше на добро ниво. Майсторът беше компетентен и си свърши задълженията без значителни грешки. Като цяло съм доволен от услугите му.",
            "Майсторът се справи прилично. Въпреки че имаше дребни закъснения, крайният резултат беше добър. Не съм разочарован.",
            "Работата беше изпълнена със задоволително качество. Ще обмисля дали отново да използвам услугите му.",
            "Не съм напълно доволен. Изпълнението беше средно и комуникацията не беше на очакваното ниво.",
            "Работата беше добра, но не впечатляваща. Очаквах малко по-добър краен резултат, но не беше лошо.",
            "Всичко беше свършено в срок и без забележки. Качеството беше добро, но не изключително.",
            "Майсторът беше отзивчив и изпълни задачите според договореното. Имаше дребни забележки, но нищо съществено.",
            "Работата беше прилична, но не бих казал, че надмина очакванията ми. Можеше да е по-добре организирано.",
            "Като цяло съм доволен от свършената работа. Всичко беше направено според договореното, макар и с малки забавяния.",
            "Майсторът беше компетентен и си разбира от работата. Резултатът отговаряше на очакванията ми.",

            # Super long feedbacks
            "Работата беше изпълнена на изключително високо ниво. Майсторът беше много коректен и внимателен към детайлите. Обясняваше всичко, което прави, и беше много организиран. Ще го препоръчам на всичките си приятели. Възхитен съм от професионализма и качеството на услугите му.",
            "Не съм доволен от крайния резултат. Майсторът беше некоректен и не изпълни задачата според договореното. Наложи се да търся друг професионалист, за да довърши и коригира допуснатите грешки. Цената също не отговаряше на качеството. Не бих използвал услугите му отново.",
            "Много съм доволен от работата на този майстор. Задачата беше изпълнена с голямо внимание към детайлите и качеството. Въпреки че имаше малки закъснения, крайният резултат беше впечатляващ. Майсторът беше много комуникативен и обясняваше всеки етап от процеса.",
            "Работата беше изпълнена професионално, макар и с известни забавяния. Майсторът беше учтив, но понякога трудно достъпен за въпроси. Качеството на работа беше задоволително и като цяло съм доволен от резултата. Може би ще използвам услугите му отново в бъдеще.",
            "Качеството на работа беше високо и майсторът беше професионален. Работата беше завършена навреме и без проблеми. Бих го препоръчал на приятели. Единственото ми оплакване е, че комуникацията можеше да бъде по-добра и по-ясна. Като цяло съм много доволен.",
            "Изключително съм доволен от свършената работа! Майсторът беше професионалист във всяко отношение – от точността до качеството на крайния резултат. Препоръчвам го на всеки, който търси надеждност и внимание към детайла. Цената също беше напълно разумна и справедлива."
]


class Command(BaseCommand):
    help = 'Creating feedbacks for all contractor public models'

    def handle(self, *args, **options):

        MIN_RATING = 1
        MAX_RATING = 5

        MIN_NUM_OF_FEEDBACKS = 1
        MAX_NUM_OF_FEEDBACKS = 8

        contractor_public_models = ContractorPublicModel.objects.all()

        for contractor in contractor_public_models:

            all_users = BaseUserModel.objects.all()
            num_of_feedbacks = random.randint(MIN_NUM_OF_FEEDBACKS, MAX_NUM_OF_FEEDBACKS)

            for _ in range(num_of_feedbacks):

                random_user_who_left_the_feedback = random.choice(all_users)

                new_client_feedback = ClientFeedbackModel.objects.create(
                    public_contractor=contractor,
                    client_user=random_user_who_left_the_feedback,
                    rating=random.randint(MIN_RATING, MAX_RATING),
                    comment=random.choice(feedbacks),
                    approved=True,
                )

                new_client_feedback.save()

                self.stdout.write(
                    self.style.SUCCESS(f"Created ClientFeedback for contractor {contractor} by {random_user_who_left_the_feedback.username}"))