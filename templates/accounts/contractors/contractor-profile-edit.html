{% extends 'common/base.html' %}

{% block title %}
    Редактиране на профил
{% endblock %}


{% block content %}

    <div class="form-section">

        <h1>Редактиране на профил</h1>

        <form method="post" enctype="multipart/form-data">

            {% csrf_token %}

            <h3>Профилна снимка</h3>

            <div class="image-object-line">

                {% if form.instance.profile_image %}

                    <div class="image-container">

                        <img src="{{ form.instance.profile_image.url }}">

                    </div>

                {% endif %}

                <div class="image-upload-container">
                    <label for="id_profile_image">Смени</label>
                    {{ form.profile_image }}

                </div>

            </div>

            <p>{{ form.first_name }}</p>
            <p>{{ form.last_name }}</p>

            <!-- Render the rest of the form -->
            <p>{{ form.phone_number }}</p>
            <p class="about-me-input">{{ form.about_me }}</p>
            <p class="regions-input">{{ form.regions }}</p>
            <p class="specializations-input">{{ form.specializations }}</p>


            <button class="fancy special-class credentials">Запази</button>
        </form>

    </div>

{% endblock %}

{% block scripts %}
    <script>
        $(document).ready(function () {
            // Initialize Select2 on the 'regions' field
            $('#id_regions').select2({
                placeholder: 'Изберете области или градове:',
                multiple: true,  // Allow multiple selections
                closeOnSelect: false  // Keep dropdown open after selecting
            });
            $('#id_specializations').select2({
                placeholder: 'Изберете специалности:',
                multiple: true,
                closeOnSelect: false
            });

            $('#id_regions, #id_specializations').on('select2:open', function () {
                // Get the current width of the body
                var bodyWidth = $('body').outerWidth();

                // Apply 'overflow: hidden' to body and set the body width to prevent layout shift
                $('body').css({
                    'overflow': 'hidden',
                    'padding-right': window.innerWidth - bodyWidth + 'px'  // Account for scrollbar width
                });
            });

            // Re-enable scrolling when the Select2 dropdown closes
            $('#id_regions, #id_specializations').on('select2:close', function () {
                // Reset overflow and padding-right to restore layout
                $('body').css({
                    'overflow': 'auto',
                    'padding-right': '0'
                });
            });


        });
    </script>
{% endblock %}